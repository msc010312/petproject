<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/temp}">
<!-- title -->
<th:block layout:fragment="title">
    reserve
</th:block>

<!-- css -->
<th:block layout:fragment="css">
    <link rel="stylesheet" href="/css/reserve.css">
    <link rel="stylesheet" href="/css/reservemodal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</th:block>

<!-- script -->
<th:block layout:fragment="script">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr" defer></script>
    <script src="js/reserve.js" defer></script>
    <script src="js/reservemodal.js" defer></script>
    <script src="js/reservePay.js" defer></script>
    <script src="https://cdn.iamport.kr/v1/iamport.js"></script>
    <script th:inline="javascript">
        let ownerId = [[${owner.ownerId}]];
        let ownerName = [[${owner.user.name}]];
        let ownerEmail = [[${owner.user.email}]];
    </script>
    <script th:inline="javascript">
        let ownerAddress = [[${owner.user.address}]];
        let sitterList = [
            /*[# th:each="sitter, iterStat : ${sitters}"]*/
            {
                id: /*[[${sitter.sitterId}]]*/,
                name: /*[[${sitter.user.name}]]*/,
                address: /*[[${sitter.user.address}]]*/,
                dayPrice: /*[[${sitter.dayPrice}]]*/,
                hotelPrice: /*[[${sitter.hotelPrice}]]*/,
                walkPrice: /*[[${sitter.walkPrice}]]*/
            }/*[# th:if="${!iterStat.last}"]*/,/*[/]*/
            /*[/]*/
        ];
    </script>

</th:block>

<!-- ì‘ì—… ì˜ì—­ -->
<div class="content" layout:fragment="content">
    <div th:replace="modal/reservemodal :: sitterDetail">
        <div id="modal-inner"></div>
    </div>
    <h1 class="title">ì˜ˆì•½í•˜ê¸°</h1>
    <div class="tabs">
        <button class="tab active" data-type="daycare">ë°ì´ì¼€ì–´</button>
        <button class="tab" data-type="hotel">í˜¸í…”ë§</button>
        <button class="tab" data-type="walk">ì‚°ì±…</button>
    </div>

    <!-- ë˜í¼ div ì¶”ê°€ ì‹œì‘ -->
    <div class="reservation-wrapper">
        <div class="reservation-container">
            <div id="reservationHeader" class="reservation-header">
                <h2>ë°ì´ì¼€ì–´ ì˜ˆì•½</h2>
                <div class="form-group">
                    <label>ë°ì´ì¼€ì–´ ë‚ ì§œì™€ ì‹œê°„ì„ ì…ë ¥í•˜ì„¸ìš”</label>
                    <div class="date-time">
                        <div class="input-icon">
                            <input type="text" class="date-picker" placeholder=" ğŸ“… ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”">
                        </div>
                        <div class="input-icon">
                            <input type="text" class="time-picker" placeholder="â° ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>ë°˜ë ¤ë™ë¬¼ ì •ë³´ë‚˜ ìš”ì²­ì‚¬í•­</label>
                    <textarea></textarea>
                </div>
                <div class="form-group">
                    <label>ìœ„ì¹˜</label>
                    <input type="text" id="addressInput" placeholder="ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
                    <div id="map" style="width: 100%; height: 400px; margin-top: 10px;"></div>
                </div>
            </div>
            <div class="sitter-section">
                <h2>ì‹œí„° ì„ íƒ</h2>
                <div class="sitter-card">
                    <div class="sitter-content" th:each="sitter : ${sitters}">
                        <div class="sitter-img1">
                            <!-- ì‚¬ìš©ì í”„ë¡œí•„ ì´ë¯¸ì§€ê°€ ìˆë‹¤ë©´ UserEntityì— ìˆëŠ” í•„ë“œ ì‚¬ìš© -->
                            <img th:src="${sitter.user.profileImageUrl != null ? sitter.user.profileImageUrl : '/path/to/default-image.jpg'}"/>
                        </div>
                        <div class="sitter-info">
                            <p>ì´ë¦„ : <strong th:text="${sitter.user.name}"></strong></p>
                            <p>ì§€ì—­ : <span th:text="${sitter.user.address}"></span></p>
                        </div>
                        <div class="sitter-price">
                            <p>ë°ì´ì¼€ì–´ : <span th:text="${#numbers.formatInteger(sitter.dayPrice, 3, 'COMMA')}">0</span>ì›/ì¼
                            </p>
                            <p>í˜¸í…”ë§ : <span th:text="${#numbers.formatInteger(sitter.hotelPrice, 3, 'COMMA')}">0</span>ì›/ì¼
                            </p>
                            <p>ì‚°ì±… : <span th:text="${#numbers.formatInteger(sitter.walkPrice, 3, 'COMMA')}">0</span>ì›/íšŒ
                            </p>
                        </div>
                        <div class="sitter-details">
                            <button class="details-btn"
                                    th:attr="data-id=${sitter.sitterId},
                                    data-dayprice=${sitter.dayPrice},
                                    data-hotelprice=${sitter.hotelPrice},
                                    data-walkprice=${sitter.walkPrice},
                                    data-presentation=${sitter.presentation},
                                    data-profileimage=${sitter.user.profileImageUrl}">
                                ìƒì„¸ ì •ë³´
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="reservation-info">
            <input type="hidden" id="buyerEmail" th:value="${email}">
            <input type="hidden" id="buyerTel" th:value="${phone}">
            <input type="hidden" id="buyerName" th:value="${name}">
            <h3>ì˜ˆì•½ ì •ë³´</h3>
            <div class="location">
                <div class="info-line">
                    <span class="info-label">ì„œë¹„ìŠ¤:</span>
                    <span class="info-value" id="reservation-service">ë°ì´ì¼€ì–´ ì„œë¹„ìŠ¤</span>
                </div>
                <div class="info-line">
                    <span class="info-label">ìœ„ì¹˜:</span>
                    <span class="info-value" id="reservation-location">ëŒ€êµ¬ê´‘ì—­ì‹œ ë™êµ¬ ì‹ ì²œë¡œ</span>
                </div>
                <div class="info-line">
                    <span class="info-label">ì‹œê°„:</span>
                    <span class="info-value" id="reservation-time"></span>
                </div>
            </div>
            <div class="location">
                <p><span>ê¸°ë³¸ ê°€ê²©:</span> <span id="reservation-price">0ì›</span></p>
                <p><span>ì´ ê²°ì œ ê¸ˆì•¡:</span> <span id="reservation-total">0ì›</span></p>
            </div>
            <div class="payment-method">
                <p>ê²°ì œ ë°©ë²•</p>
                <label><input type="radio" name="payment"> ì‹ ìš©/ì²´í¬ì¹´ë“œ</label><br>
                <label><input type="radio" name="payment"> ê³„ì¢Œì´ì²´</label><br>
                <label><input type="radio" name="payment"> í˜„ì¥ ê²°ì œ</label>
            </div>
            <button class="reserve-btn" onclick="pay()">ì˜ˆì•½í•˜ê¸°</button>
        </div>
    </div>
    <!-- ë˜í¼ div ì¶”ê°€ ë -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBYyYVE-Fxs1sm7rsudqBgok6iAqx5aQoM&libraries=places"
            async defer></script>
</div>
</html>
